@using System.Security.Claims
@{
    var fullname = User.FindFirstValue("Fullname") ?? User.Identity?.Name;
}

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>@ViewData["Title"] - WebApplication2</title>
<link rel="stylesheet" href="./lib/bootstrap/dist/css/bootstrap.min.css" />
<link rel="stylesheet" href="./css/main.css">
<link rel="stylesheet" href="./css/user.css">
<link rel="stylesheet" href="./css/footer.css">
<link rel="stylesheet" href="./fonts/fontawesome-free-6.5.1-web/css/all.css">
</head>

<body>
<header id="header">
    <div class="header-wrap container">
        <h2 class="header-title ">AccomodationAdmin.</h2>
        <div class="header-info">
            <div class="header-function">
                <ul class="header_function-lists">
                    <li class="function_lists-item me-2">
                        <a asp-area="User" asp-controller="Dashboard" asp-action="Index" class="function_item-url "><i class="fa-solid fa-chart-bar item_url-icon"></i></a>
                    </li>
                    <li class="function_lists-item me-2">
                        <a asp-area="User" asp-controller="PhongTro" asp-action="Index" class="function_item-url"><i class="fa-solid fa-house-user item_url-icon"></i></a>
                    </li>
                    <li class="function_lists-item me-2">
                        <a asp-area="User" asp-controller="HopDong" asp-action="Index" class="function_item-url"><i class="fa-solid fa-building-shield item_url-icon"></i></a>
                    </li>
                </ul>
            </div>
            <div class="header-login">
                <img class="header-login_avatar" src="/images/R.jpg" alt="Avatar">
                <span class="header_login-name">@fullname</span>
                <div class="login-submenu">
                    <ul class="login-submenu_list">
                        <li class="submenu-list_item"><a asp-area="User" asp-controller="Profile" asp-action="Profile" class="list-item_url">Thông tin</a></li>
                        <li class="submenu-list_item"><a href="#" class="list-item_url">Settings</a></li>
                        <li class="submenu-list_item">
                            <form method="post" asp-area="Identity" asp-page="/Account/Logout">
                                <button type="submit" class="list-item_url" style="border: none; background: none; color: inherit; cursor: pointer;">Đăng xuất</button>
                            </form>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</header>

<section id="slider">
    <div id="carouselExampleControlsNoTouching" class="carousel slide" data-bs-touch="false">
        <div class="carousel-inner ">
            <div class="carousel-item active">
                <img src="/images/OIP (1).jpg" class="d-block w-100 " alt="...">
            </div>
            <div class="carousel-item">
                <img src="/images/OIP (2).jpg" class="d-block w-100" alt="...">
            </div>
            <div class="carousel-item">
                <img src="/images/OIP (3).jpg" class="d-block w-100" alt="...">
            </div>
        </div>
        <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControlsNoTouching"
                data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
        </button>
        <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControlsNoTouching"
                data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
        </button>
    </div>
    <div class="slider_content">
        <h1 class="slider_content-title">
            Chào mừng <span>@fullname</span> đến
            <span>113 Cô Giang</span>
        </h1>
        <p class="slider_content-description">
                Cô Giang là một khu trọ đầy an ninh.
        </p>
    </div>
</section>


<main id="body">
    <div class="container">
        <div class="row">          
            <div class="col-12 content-wrap">
                @RenderBody()
            </div>
        </div>
    </div>
</main>

    <footer id="footer" class="border-top  text-muted">
        <div class="container my-5">
            <div class="row">
                <div class="col-md-6 footer_info border-end">
                    <h3 class="mb-3">HutechAccmodation.</h3>
                    <p style="text-align: justify; margin-right: 14px;">
                        Nhà trọ 133 Cô Giang – không gian yên tĩnh giữa lòng thành phố, phù hợp cho người thích sự riêng tư. Kiến trúc cổ điển, hành lang sâu và ánh sáng mờ tạo cảm giác trầm lắng, tách biệt với thế giới bên ngoài. Một lựa chọn lý tưởng cho những ai muốn trải nghiệm cảm giác "khác biệt".
                    </p>
                </div>

                <div class="col-md-3 footer_links border-end">
                    <h3 class="mb-3 ms-4">Đường dẫn nhanh</h3>
                    <ul class="footer_links-list ms-3">
                        <li class="links_list-item"><a class="list-item-url" asp-area="User" asp-controller="Dashboard" asp-action="Index">Dashboard</a></li>
                        <li class="links_list-item"><a class="list-item-url" asp-area="User" asp-controller="PhongTro" asp-action="Index">Rooms</a></li>
                        <li class="links_list-item"><a class="list-item-url" asp-area="User" asp-controller="HopDong" asp-action="Index">Appointment</a></li>
                        <li class="links_list-item"><a class="list-item-url" href="#">Terms</a></li>
                        <li class="links_list-item"><a class="list-item-url" asp-area="User" asp-controller="Contact" asp-action="Contact" >Contact Us</a></li>
                    </ul>
                </div>

                <div class="col-md-3 footer_contact">
                    <h3 class="mb-3">Liên hệ</h3>
                    <ul class="footer_contact-list">
                        <li class="contact_list-item">
                            <i style="color: #000;" class="fa-solid fa-location-dot me-2"></i>
                            <a class="list_item-con-url" href="#">201/10 Xa Lộ Hà Nội, Tp.Thủ Đức</a>
                        </li>

                        <li class="contact_list-item me-2">
                            <i style="color: #000;" class="fa-solid fa-phone me-2"></i>
                            <a class="list_item-con-url" href="#">0912000023</a>
                        </li>

                        <li class="contact_list-item">
                            <i style="color: #000;" class="fa-solid fa-envelope me-2"></i>
                            <a class="list_item-con-url" href="#">hutechAccom@gmail.com</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>

        <div style="background-color: #000;" class="footer_copyright">
            <div class="container">
                <div class="row justify-content-between">
                    <div class="col-md-6 mt-3">
                        <p style="color: white;">Copyright by Chill's Team</p>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <div id="customAlert" class="custom-alert">
        <span id="customAlertMessage"></span>
    </div>
</body>
</html>


<script src="https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/7.0.5/signalr.min.js"></script>
<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
<script src="~/js/site.js" asp-append-version="true"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/jquery.validate.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validation-unobtrusive/3.2.11/jquery.validate.unobtrusive.min.js"></script>
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
@await RenderSectionAsync("Scripts", required: false)

<script>
     const connection = new signalR.HubConnectionBuilder()
         .withUrl("/bookingHub")
         .configureLogging(signalR.LogLevel.Information)
         .build();

     connection.start()
         .then(() => console.log("✅ Kết nối SignalR thành công!"))
         .catch(err => console.error("❌ Lỗi kết nối SignalR:", err));

     // Cập nhật trạng thái phòng
     connection.on("BookingStatusChanged", (roomId, status) => {
         console.log(`📩 Phòng ${roomId} có trạng thái mới: ${status}`);

         if (status === "Thành công") {
             showCustomAlert(`Yêu cầu thuê phòng ${roomId} đã thành công!`, false);
         } else {
             showCustomAlert(`Yêu cầu thuê phòng ${roomId} đã bị từ chối!`, true);
         }
     });

     // Hàm hiển thị thông báo tùy chỉnh
    function showCustomAlert(message, isError = false) {
         var alertBox = document.getElementById("customAlert");
         var alertMessage = document.getElementById("customAlertMessage");

         if (!alertBox || !alertMessage) {
             console.warn("❗ Không tìm thấy phần tử thông báo.");
             return;
         }

         alertBox.classList.remove("error"); // reset trạng thái
         if (isError) {
             alertBox.classList.add("error");
         }

         alertMessage.textContent = message;
         alertBox.style.display = "block";

         setTimeout(function () {
             alertBox.style.display = "none";
         }, 3000);
     }



</script>

<style>
    .custom-alert {
        position: fixed;
        top: 20px;
        right: 20px;
        background-color: #4CAF50;
        color: white;
        padding: 15px 20px;
        border-radius: 8px;
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        display: none;
        z-index: 9999;
        font-size: 16px;
        max-width: 300px;
        animation: slideIn 0.3s ease;
    }

        .custom-alert.error {
            background-color: #f44336;
        }

    @@keyframes slideIn {
        from {
            transform: translateY(-30px);
            opacity: 0;
        }

        to {
            transform: translateY(0);
            opacity: 1;
        }
    }

</style>

